{"version":3,"sources":["../../../src/webpage/assembler/assembler.ts"],"sourcesContent":["import {Ram} from \"../emulator/ram.js\";\nimport {I18n} from \"../i18n.js\";\nimport {parsedPart, parseLine} from \"./parser.js\";\nimport {instructions, registerNames} from \"../fetches.js\";\n\nconst regNames = new Map<string, {type: \"register\"; number: number; floating: boolean}>([\n\t...registerNames.int\n\t\t.map((_, i) => {\n\t\t\treturn _.map(\n\t\t\t\t(_) =>\n\t\t\t\t\t[\n\t\t\t\t\t\t_,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttype: \"register\",\n\t\t\t\t\t\t\tnumber: i,\n\t\t\t\t\t\t\tfloating: false,\n\t\t\t\t\t\t},\n\t\t\t\t\t] as [string, {type: \"register\"; number: number; floating: boolean}],\n\t\t\t);\n\t\t})\n\t\t.flat(1),\n\t...registerNames.float\n\t\t.map((_, i) => {\n\t\t\treturn _.map(\n\t\t\t\t(_) =>\n\t\t\t\t\t[\n\t\t\t\t\t\t_,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttype: \"register\",\n\t\t\t\t\t\t\tnumber: i,\n\t\t\t\t\t\t\tfloating: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t] as [string, {type: \"register\"; number: number; floating: boolean}],\n\t\t\t);\n\t\t})\n\t\t.flat(1),\n]);\nconst instMap = new Map(\n\tinstructions.map((_) => {\n\t\tconst name = _.name;\n\t\treturn [name, _];\n\t}),\n);\nconst fakeMap = new Map(\n\tinstructions\n\t\t.filter((_) => _.type === \"fake\")\n\t\t.map((inst) => {\n\t\t\treturn [\n\t\t\t\tinst.name,\n\t\t\t\t{\n\t\t\t\t\tname: inst.name,\n\t\t\t\t\targs: inst.args.map((_, i) => i + 1 + \"\"),\n\t\t\t\t\tlines: inst.replace.split(\"\\n\").map((_) => [...parseLine(_)]),\n\t\t\t\t\tline: NaN,\n\t\t\t\t},\n\t\t\t];\n\t\t}),\n);\n\ntype symbolType =\n\t| {\n\t\t\tcontent: string;\n\t\t\ttype: \"variable\" | \"label\";\n\t  }\n\t| {\n\t\t\tcontent: string;\n\t\t\ttype: \"string\";\n\t  }\n\t| {\n\t\t\ttype: \"register\";\n\t\t\tnumber: number;\n\t\t\tfloating: boolean;\n\t  }\n\t| {\n\t\t\tcontent: string;\n\t\t\ttype: \"instruction\";\n\t  }\n\t| {\n\t\t\ttype: \"directive\";\n\t\t\tcontent: string;\n\t  }\n\t| {\n\t\t\ttype: \"unknown\";\n\t\t\tcontent: string;\n\t  }\n\t| {\n\t\t\ttype: \"parentheses\";\n\t\t\tcontains: symbolType[];\n\t  }\n\t| {\n\t\t\ttype: \"int\";\n\t\t\tcontent: bigint;\n\t  }\n\t| {\n\t\t\ttype: \"float\";\n\t\t\tcontent: number;\n\t  };\nclass AssemblError extends Error {\n\treadonly line: number;\n\treadonly file: string;\n\ttrace: [number, string][] = [];\n\tconstructor(reason: string, line: number, file: string) {\n\t\tsuper(reason);\n\t\tthis.line = line;\n\t\tthis.file = file;\n\t}\n\taddTrace(line: number, file: string) {\n\t\tthis.trace.push([line, file]);\n\t}\n}\ntype linkerInfo = Map<\n\tnumber,\n\t{\n\t\tlabel: string;\n\t\ttype: \"dword\" | \"word\" | \"byte\" | \"half\" | \"I\" | \"RI\" | \"S\" | \"RS\" | \"B\" | \"U\" | \"AU\" | \"J\";\n\t\tline: number;\n\t\tfile: string;\n\t}\n>;\ntype macro = {\n\tname: string;\n\targs: string[];\n\tlines: parsedPart[][];\n\tline: number;\n};\ntype labelMap = Map<string, number>;\nfunction assemble(files: [string, string][]) {\n\tconst textView = new DataView(new ArrayBuffer(1 << 22));\n\tlet textIndex = 0;\n\n\tconst dataView = new DataView(new ArrayBuffer(1 << 22));\n\tlet dataIndex = 0;\n\n\tconst globalDataLabels: linkerInfo = new Map();\n\tconst globalLabelMap: labelMap = new Map();\n\n\tfunction link(labelMap: labelMap, dataLables: linkerInfo, globalRun = false) {\n\t\tconst ram = new Ram(dataView, textView, [dataIndex, textIndex, 1 << 22]);\n\n\t\tfor (const [address, thing] of dataLables) {\n\t\t\tconst label = labelMap.get(thing.label);\n\n\t\t\tif (!label) {\n\t\t\t\tif (globalRun) {\n\t\t\t\t\tthrow new AssemblError(\n\t\t\t\t\t\tI18n.errors.unmatchedLabel(thing.line + \"\", thing.label),\n\t\t\t\t\t\tthing.line,\n\t\t\t\t\t\tthing.file,\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tglobalDataLabels.set(address, thing);\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\t\t\tswitch (thing.type) {\n\t\t\t\tcase \"byte\":\n\t\t\t\t\tram.setInt8(address, label);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"half\":\n\t\t\t\t\tram.setInt16(address, label);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"word\":\n\t\t\t\t\tram.setInt32(address, label);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"dword\":\n\t\t\t\t\tram.setBigInt64(address, label);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"U\": {\n\t\t\t\t\tconst inst = ram.getInt32(address);\n\t\t\t\t\tram.setInt32(address, (label & 0xfffff000) | inst);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcase \"AU\": {\n\t\t\t\t\tconst inst = ram.getInt32(address);\n\t\t\t\t\tlet offset = label - address;\n\t\t\t\t\tif ((offset & 0xfff) > 2047) offset += 0x1000;\n\t\t\t\t\tram.setInt32(address, (offset & 0xfffff000) | inst);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcase \"I\": {\n\t\t\t\t\tconst inst = ram.getInt32(address);\n\t\t\t\t\tram.setInt32(address, ((label & 0xfff) << 20) | inst);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcase \"RI\": {\n\t\t\t\t\tconst inst = ram.getInt32(address);\n\t\t\t\t\tram.setInt32(address, (((label - address + 4) & 0xfff) << 20) | inst);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcase \"B\": {\n\t\t\t\t\tconst inst = ram.getInt32(address);\n\t\t\t\t\tconst offset = label - address;\n\t\t\t\t\tif (offset & 1) {\n\t\t\t\t\t\tthrow new AssemblError(I18n.errors.evilJump(thing.line + \"\"), thing.line, thing.file);\n\t\t\t\t\t}\n\t\t\t\t\tconst evil =\n\t\t\t\t\t\t((offset & 0b11110) << 7) |\n\t\t\t\t\t\t((offset & 0b11111100000) << 20) |\n\t\t\t\t\t\t((offset & 0b100000000000) >>> 4) |\n\t\t\t\t\t\t((offset & 0b1000000000000) << 19);\n\t\t\t\t\tconsole.log((evil >>> 0).toString(2).padStart(32, \"0\"), offset.toString(16));\n\t\t\t\t\tram.setInt32(address, evil | inst);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcase \"J\": {\n\t\t\t\t\tconst inst = ram.getInt32(address);\n\t\t\t\t\tconst offset = label - address;\n\t\t\t\t\tif (offset & 1) {\n\t\t\t\t\t\tthrow new AssemblError(I18n.errors.evilJump(thing.line + \"\"), thing.line, thing.file);\n\t\t\t\t\t}\n\t\t\t\t\tconst evil =\n\t\t\t\t\t\t((offset & 0b11111111110) << 20) ^\n\t\t\t\t\t\t((offset & 0b100000000000) << 9) ^\n\t\t\t\t\t\t(offset & 0b11111111000000000000) ^\n\t\t\t\t\t\t((offset & 0b100000000000000000000) << 11);\n\t\t\t\t\tconsole.log((evil >>> 0).toString(2).padStart(32, \"0\"), offset.toString(16));\n\t\t\t\t\tram.setInt32(address, evil | inst);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tdefault:\n\t\t\t\t\tthrow new AssemblError(\n\t\t\t\t\t\t\"Internal error, fix me unhandled linking case:\" + thing.type,\n\t\t\t\t\t\tNaN,\n\t\t\t\t\t\tthing.file,\n\t\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\treturn ram;\n\t}\n\tfor (const [code, file] of files) {\n\t\tfunction getCurAddress() {\n\t\t\tif (place == \"data\") {\n\t\t\t\treturn dataIndex + 0x10010000;\n\t\t\t} else if (place == \"text\") {\n\t\t\t\treturn textIndex + 0x00400000;\n\t\t\t} else {\n\t\t\t\tthrow new AssemblError(\"internal error please fix\", NaN, file);\n\t\t\t}\n\t\t}\n\n\t\tconst basicParsing = code.split(\"\\n\").map((_) => parseLine(_));\n\n\t\tlet directive: \"double\" | \"float\" | \"dword\" | \"word\" | \"byte\" | \"half\" | \"ascii\" | \"asciz\" =\n\t\t\t\"word\";\n\t\tlet place: \"text\" | \"data\" = \"text\";\n\n\t\tconst globalLabelSet = new Set<[string, number]>();\n\t\tfunction assembleParsed(\n\t\t\tbasicParsing: Generator<parsedPart, void, unknown>[] | parsedPart[][],\n\t\t\tdataLables: linkerInfo = new Map(),\n\t\t\tlabelMap: labelMap = new Map(),\n\t\t\tvarMap = new Map<string, symbolType>(),\n\t\t\tmacros = new Map<string, macro>(),\n\t\t\ti = 0,\n\t\t) {\n\t\t\tlet macroBuild: macro | undefined;\n\t\t\tfunction placeData(\n\t\t\t\tdata:\n\t\t\t\t\t| {type: \"int\"; content: bigint}\n\t\t\t\t\t| {type: \"float\"; content: number}\n\t\t\t\t\t| {type: \"string\"; content: string}\n\t\t\t\t\t| {type: \"unknown\"; content: string}\n\t\t\t\t\t| {\n\t\t\t\t\t\t\ttype: \"instruction\";\n\t\t\t\t\t\t\tcontent: number;\n\t\t\t\t\t\t\tlink?: {type: \"I\" | \"RI\" | \"S\" | \"RS\" | \"B\" | \"U\" | \"AU\" | \"J\"; label: string};\n\t\t\t\t\t  },\n\t\t\t) {\n\t\t\t\tif (place === \"text\" && data.type !== \"instruction\") {\n\t\t\t\t\tif (data.type === \"int\") {\n\t\t\t\t\t\tthrow new AssemblError(I18n.errors.dataInText(i + 1 + \"\", data.content + \"\"), i, file);\n\t\t\t\t\t}\n\t\t\t\t\tthrow new AssemblError(\n\t\t\t\t\t\tI18n.errors.dataInText(i + 1 + \"\", JSON.stringify(data.content)),\n\t\t\t\t\t\ti,\n\t\t\t\t\t\tfile,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tif ((directive === \"ascii\" || directive === \"asciz\") && place === \"data\") {\n\t\t\t\t\tif (data.type !== \"string\") {\n\t\t\t\t\t\tthrow new AssemblError(I18n.errors.notAString(i + 1 + \"\", data.type), i, file);\n\t\t\t\t\t}\n\t\t\t\t\tconst encode = new TextEncoder().encode(data.content);\n\t\t\t\t\tfor (const char of encode) {\n\t\t\t\t\t\tdataView.setUint8(dataIndex, char);\n\t\t\t\t\t\tdataIndex += 1;\n\t\t\t\t\t}\n\t\t\t\t\tif (directive === \"asciz\") {\n\t\t\t\t\t\tdataView.setUint8(dataIndex, 0);\n\t\t\t\t\t\tdataIndex += 1;\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\t} else if (data.type === \"string\") {\n\t\t\t\t\tthrow new AssemblError(I18n.errors.stringOutsideOfDirrective(i + 1 + \"\"), i, file);\n\t\t\t\t}\n\t\t\t\tif (data.type === \"float\") {\n\t\t\t\t\tif (directive === \"float\") {\n\t\t\t\t\t\tdataView.setFloat32(dataIndex, data.content, true);\n\t\t\t\t\t\tdataIndex += 4;\n\t\t\t\t\t} else if (directive === \"double\") {\n\t\t\t\t\t\tdataView.setFloat64(dataIndex, data.content, true);\n\t\t\t\t\t\tdataIndex += 8;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthrow new AssemblError(I18n.errors.wrongDirrectiveFloat(i + 1 + \"\"), i, file);\n\t\t\t\t\t}\n\t\t\t\t} else if (data.type == \"int\") {\n\t\t\t\t\tif (directive === \"byte\") {\n\t\t\t\t\t\tdataView.setUint8(dataIndex, Number(data.content & 0xffn));\n\t\t\t\t\t\tdataIndex += 1;\n\t\t\t\t\t} else if (directive === \"half\") {\n\t\t\t\t\t\tdataView.setUint16(dataIndex, Number(data.content & 0xffffn), true);\n\t\t\t\t\t\tdataIndex += 2;\n\t\t\t\t\t} else if (directive === \"word\") {\n\t\t\t\t\t\tdataView.setUint32(dataIndex, Number(data.content & 0xffffffffn), true);\n\t\t\t\t\t\tdataIndex += 4;\n\t\t\t\t\t} else if (directive === \"dword\") {\n\t\t\t\t\t\tdataView.setBigUint64(dataIndex, data.content, true);\n\t\t\t\t\t\tdataIndex += 8;\n\t\t\t\t\t} else if (directive === \"float\") {\n\t\t\t\t\t\tdataView.setFloat32(dataIndex, Number(data.content), true);\n\t\t\t\t\t\tdataIndex += 4;\n\t\t\t\t\t} else if (directive === \"double\") {\n\t\t\t\t\t\tdataView.setFloat64(dataIndex, Number(data.content), true);\n\t\t\t\t\t\tdataIndex += 8;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthrow new AssemblError(\"internal error, please fix\", NaN, file);\n\t\t\t\t\t}\n\t\t\t\t} else if (data.type === \"unknown\") {\n\t\t\t\t\tif (directive == \"float\" || directive == \"double\") {\n\t\t\t\t\t\tthrow new AssemblError(I18n.errors.lableCantFloat(i + 1 + \"\"), i, file);\n\t\t\t\t\t} else if (directive !== \"ascii\" && directive != \"asciz\") {\n\t\t\t\t\t\tdataLables.set(getCurAddress(), {label: data.content, type: directive, line: i, file});\n\t\t\t\t\t\tif (directive === \"byte\") {\n\t\t\t\t\t\t\tdataIndex += 1;\n\t\t\t\t\t\t} else if (directive === \"half\") {\n\t\t\t\t\t\t\tdataIndex += 2;\n\t\t\t\t\t\t} else if (directive === \"word\") {\n\t\t\t\t\t\t\tdataIndex += 4;\n\t\t\t\t\t\t} else if (directive === \"dword\") {\n\t\t\t\t\t\t\tdataIndex += 8;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthrow new AssemblError(\"internal error, please fix\", NaN, file);\n\t\t\t\t\t}\n\t\t\t\t} else if (data.type === \"instruction\") {\n\t\t\t\t\tif (data.link) {\n\t\t\t\t\t\tdataLables.set(getCurAddress(), {\n\t\t\t\t\t\t\tlabel: data.link.label,\n\t\t\t\t\t\t\ttype: data.link.type,\n\t\t\t\t\t\t\tline: i,\n\t\t\t\t\t\t\tfile,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tif (place === \"text\") {\n\t\t\t\t\t\ttextView.setUint32(textIndex, data.content, true);\n\t\t\t\t\t\ttextIndex += 4;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdataView.setUint32(dataIndex, data.content, true);\n\t\t\t\t\t\tdataIndex += 4;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthrow new AssemblError(\"internal error, please fix\", NaN, file);\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (const line of basicParsing) {\n\t\t\t\tlet s = 0;\n\t\t\t\tconst lineArr = [...line];\n\t\t\t\tif (macroBuild) {\n\t\t\t\t\tif (\n\t\t\t\t\t\tlineArr.length === 1 &&\n\t\t\t\t\t\tlineArr[0].type == \"directive\" &&\n\t\t\t\t\t\tlineArr[0].content == \".end_macro\"\n\t\t\t\t\t) {\n\t\t\t\t\t\tmacros.set(macroBuild.name, macroBuild);\n\t\t\t\t\t\tmacroBuild = undefined;\n\t\t\t\t\t\ti++;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tmacroBuild.lines.push(lineArr);\n\t\t\t\t\ti++;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tfunction handleDirrective(data: {type: \"directive\"; content: string}) {\n\t\t\t\t\tswitch (data.content) {\n\t\t\t\t\t\tcase \"data\":\n\t\t\t\t\t\t\tplace = \"data\";\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"text\":\n\t\t\t\t\t\t\tplace = \"text\";\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"ascii\":\n\t\t\t\t\t\tcase \"asciz\":\n\t\t\t\t\t\tcase \"double\":\n\t\t\t\t\t\tcase \"float\":\n\t\t\t\t\t\tcase \"byte\":\n\t\t\t\t\t\tcase \"word\":\n\t\t\t\t\t\tcase \"dword\":\n\t\t\t\t\t\tcase \"half\":\n\t\t\t\t\t\t\tif (place === \"text\") {\n\t\t\t\t\t\t\t\tthrow new AssemblError(I18n.errors.dataDirectiveInText(i + 1 + \"\"), i, file);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdirective = data.content;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"global\":\n\t\t\t\t\t\tcase \"globl\":\n\t\t\t\t\t\t\tlet label = getNextSymbol();\n\t\t\t\t\t\t\tif (!label) {\n\t\t\t\t\t\t\t\tthrow new AssemblError(I18n.errors.expectGlobal(i + 1 + \"\", data.content), i, file);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\twhile (label) {\n\t\t\t\t\t\t\t\tif (label.type !== \"unknown\") {\n\t\t\t\t\t\t\t\t\tthrow new AssemblError(\n\t\t\t\t\t\t\t\t\t\tI18n.errors.expectedLabel(i + 1 + \"\", data.content),\n\t\t\t\t\t\t\t\t\t\ti,\n\t\t\t\t\t\t\t\t\t\tfile,\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tglobalLabelSet.add([label.content, i]);\n\t\t\t\t\t\t\t\tlabel = getNextSymbol();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"macro\":\n\t\t\t\t\t\t\tconst name = getNextSymbol();\n\t\t\t\t\t\t\tif (!name || name.type !== \"unknown\") {\n\t\t\t\t\t\t\t\tthrow new AssemblError(I18n.errors.macroName(i + 1 + \"\", data.content), i, file);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tconst params = getNextSymbol();\n\t\t\t\t\t\t\tconst args: string[] = [];\n\t\t\t\t\t\t\tif (params) {\n\t\t\t\t\t\t\t\tif (params.type !== \"parentheses\") {\n\t\t\t\t\t\t\t\t\tthrow new AssemblError(I18n.errors.macroArgs(i + 1 + \"\", data.content), i, file);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tfor (const thing of params.contains) {\n\t\t\t\t\t\t\t\t\tif (thing.type !== \"variable\") {\n\t\t\t\t\t\t\t\t\t\tthrow new AssemblError(\n\t\t\t\t\t\t\t\t\t\t\tI18n.errors.macroArgs(i + 1 + \"\", data.content),\n\t\t\t\t\t\t\t\t\t\t\ti,\n\t\t\t\t\t\t\t\t\t\t\tfile,\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\targs.push(thing.content);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tmacroBuild = {\n\t\t\t\t\t\t\t\tname: name.content,\n\t\t\t\t\t\t\t\targs,\n\t\t\t\t\t\t\t\tlines: [],\n\t\t\t\t\t\t\t\tline: i + 1,\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tthrow new AssemblError(\n\t\t\t\t\t\t\t\tI18n.errors.unknownDirective(i + 1 + \"\", data.content),\n\t\t\t\t\t\t\t\ti,\n\t\t\t\t\t\t\t\tfile,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconst helperNext = (itterate = true) => {\n\t\t\t\t\treturn lineArr[(s += +itterate) - +itterate];\n\t\t\t\t};\n\t\t\t\tfunction getNextSymbol(helper = helperNext): symbolType | undefined {\n\t\t\t\t\tconst symbol = helper();\n\t\t\t\t\tif (!symbol) return undefined;\n\t\t\t\t\tswitch (symbol.type) {\n\t\t\t\t\t\tcase \"comment\":\n\t\t\t\t\t\tcase \"space\":\n\t\t\t\t\t\t\treturn getNextSymbol(helper);\n\t\t\t\t\t\tcase \"invalidString\":\n\t\t\t\t\t\t\tthrow new AssemblError(I18n.errors.invalidString(i + 1 + \"\"), i, file);\n\t\t\t\t\t\tcase \"invalidChar\":\n\t\t\t\t\t\t\tthrow new AssemblError(I18n.errors.invalidChar(i + 1 + \"\"), i, file);\n\t\t\t\t\t\tcase \"char\":\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\tsymbol.content.length > 3 &&\n\t\t\t\t\t\t\t\t!(symbol.content.length === 4 && symbol.content[1] == \"\\\\\")\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tthrow new AssemblError(I18n.errors.CharTooLong(i + 1 + \"\"), i, file);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif (symbol.type === \"parentheses\") {\n\t\t\t\t\t\tif (symbol.content === \"(\") {\n\t\t\t\t\t\t\tconst innards: symbolType[] = [];\n\t\t\t\t\t\t\twhile (true) {\n\t\t\t\t\t\t\t\tif (helper(false).type === \"parentheses\") {\n\t\t\t\t\t\t\t\t\tif (helper(false).content === \")\") {\n\t\t\t\t\t\t\t\t\t\ts++;\n\t\t\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\t\t\ttype: \"parentheses\",\n\t\t\t\t\t\t\t\t\t\t\tcontains: innards,\n\t\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tthrow new AssemblError(I18n.errors.ParNoMatch(i + 1 + \"\"), i, file);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tconst next = getNextSymbol(helper);\n\t\t\t\t\t\t\t\tif (!next) throw new AssemblError(I18n.errors.ParNoMatch(i + 1 + \"\"), i, file);\n\t\t\t\t\t\t\t\tinnards.push(next);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthrow new AssemblError(I18n.errors.ParNoMatch(i + 1 + \"\"), i, file);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (symbol.type === \"char\") {\n\t\t\t\t\t\tconst char = [...symbol.content];\n\t\t\t\t\t\tchar.pop();\n\t\t\t\t\t\tchar.shift();\n\t\t\t\t\t\tconst str = JSON.parse(`\"${char.join(\"\")}\"`) as string;\n\t\t\t\t\t\tif (str.length !== 1) {\n\t\t\t\t\t\t\tthrow new AssemblError(I18n.errors.CharTooLong(i + 1 + \"\"), i, file);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\ttype: \"int\",\n\t\t\t\t\t\t\tcontent: BigInt(new TextEncoder().encode(str)[0]),\n\t\t\t\t\t\t};\n\t\t\t\t\t} else if (symbol.type === \"number\") {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\ttype: \"int\",\n\t\t\t\t\t\t\t\tcontent: BigInt(symbol.content),\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t} catch {\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\ttype: \"float\",\n\t\t\t\t\t\t\t\tcontent: +symbol.content,\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (symbol.type === \"label\") {\n\t\t\t\t\t\tconst arr = [...symbol.content];\n\t\t\t\t\t\tarr.pop();\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\ttype: \"label\",\n\t\t\t\t\t\t\tcontent: arr.join(\"\"),\n\t\t\t\t\t\t};\n\t\t\t\t\t} else if (symbol.type === \"directive\") {\n\t\t\t\t\t\tconst arr = [...symbol.content];\n\t\t\t\t\t\tarr.shift();\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\ttype: \"directive\",\n\t\t\t\t\t\t\tcontent: arr.join(\"\"),\n\t\t\t\t\t\t};\n\t\t\t\t\t} else if (symbol.type === \"string\") {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\ttype: \"string\",\n\t\t\t\t\t\t\tcontent: JSON.parse(symbol.content) as string,\n\t\t\t\t\t\t};\n\t\t\t\t\t} else if (symbol.type === \"register\") {\n\t\t\t\t\t\tconst reg = regNames.get(symbol.content);\n\t\t\t\t\t\tif (reg === undefined) throw new AssemblError(\"internal error fix me\", NaN, file);\n\t\t\t\t\t\treturn reg;\n\t\t\t\t\t} else if (symbol.type === \"variable\") {\n\t\t\t\t\t\tconst arr = [...symbol.content];\n\t\t\t\t\t\tarr.shift();\n\t\t\t\t\t\tconst content = arr.join(\"\");\n\t\t\t\t\t\tconst mapped = varMap.get(content);\n\t\t\t\t\t\tif (mapped) {\n\t\t\t\t\t\t\treturn mapped;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\ttype: \"variable\",\n\t\t\t\t\t\t\tcontent,\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\treturn {\n\t\t\t\t\t\ttype: symbol.type,\n\t\t\t\t\t\tcontent: symbol.content,\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tfunction handleInstruction(data: {type: \"instruction\"; content: string}) {\n\t\t\t\t\tfunction get12Bit() {\n\t\t\t\t\t\tconst sym = getNextSymbol();\n\t\t\t\t\t\tif (!sym)\n\t\t\t\t\t\t\tthrow new AssemblError(I18n.errors.InstructionNeededMoreParams(i + 1 + \"\"), i, file);\n\t\t\t\t\t\tif (sym.type !== \"int\")\n\t\t\t\t\t\t\tthrow new AssemblError(I18n.errors.expectedInt(i + 1 + \"\"), i, file);\n\t\t\t\t\t\tif (sym.content < -2048n || sym.content > 2047n) {\n\t\t\t\t\t\t\tthrow new AssemblError(\n\t\t\t\t\t\t\t\tI18n.errors.OutOfBounts12bit(i + 1 + \"\", sym.content + \"\"),\n\t\t\t\t\t\t\t\ti,\n\t\t\t\t\t\t\t\tfile,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn Number(sym.content);\n\t\t\t\t\t}\n\t\t\t\t\tfunction getNumb() {\n\t\t\t\t\t\tconst sym = getNextSymbol();\n\t\t\t\t\t\tif (!sym)\n\t\t\t\t\t\t\tthrow new AssemblError(I18n.errors.InstructionNeededMoreParams(i + 1 + \"\"), i, file);\n\t\t\t\t\t\tif (sym.type !== \"int\")\n\t\t\t\t\t\t\tthrow new AssemblError(I18n.errors.expectedInt(i + 1 + \"\"), i, file);\n\t\t\t\t\t\treturn Number(sym.content);\n\t\t\t\t\t}\n\t\t\t\t\tfunction get5Bit() {\n\t\t\t\t\t\tconst sym = getNextSymbol();\n\t\t\t\t\t\tif (!sym)\n\t\t\t\t\t\t\tthrow new AssemblError(I18n.errors.InstructionNeededMoreParams(i + 1 + \"\"), i, file);\n\t\t\t\t\t\tif (sym.type !== \"int\")\n\t\t\t\t\t\t\tthrow new AssemblError(I18n.errors.expectedInt(i + 1 + \"\"), i, file);\n\t\t\t\t\t\tif (sym.content < 0n || sym.content > 31n) {\n\t\t\t\t\t\t\tthrow new AssemblError(\n\t\t\t\t\t\t\t\tI18n.errors.OutOfBounds5bit(i + 1 + \"\", sym.content + \"\"),\n\t\t\t\t\t\t\t\ti,\n\t\t\t\t\t\t\t\tfile,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn Number(sym.content);\n\t\t\t\t\t}\n\t\t\t\t\tfunction getRegi(float = false) {\n\t\t\t\t\t\tconst sym = getNextSymbol();\n\t\t\t\t\t\tif (!sym)\n\t\t\t\t\t\t\tthrow new AssemblError(I18n.errors.InstructionNeededMoreParams(i + 1 + \"\"), i, file);\n\t\t\t\t\t\tif (sym.type !== \"register\")\n\t\t\t\t\t\t\tthrow new AssemblError(I18n.errors.expectedRegi(i + 1 + \"\"), i, file);\n\t\t\t\t\t\tif (!float && sym.floating) {\n\t\t\t\t\t\t\tthrow new AssemblError(I18n.errors.expectIntReg(i + 1 + \"\"), i, file);\n\t\t\t\t\t\t} else if (float && !sym.floating) {\n\t\t\t\t\t\t\tthrow new AssemblError(I18n.errors.expectFloatReg(i + 1 + \"\"), i, file);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn sym.number;\n\t\t\t\t\t}\n\t\t\t\t\tfunction getOffReg(type: \"I\" | \"S\", load: false | number) {\n\t\t\t\t\t\tlet sym = getNextSymbol();\n\t\t\t\t\t\tif (!sym)\n\t\t\t\t\t\t\tthrow new AssemblError(I18n.errors.InstructionNeededMoreParams(i + 1 + \"\"), i, file);\n\t\t\t\t\t\tlet offset = 0n;\n\t\t\t\t\t\tswitch (sym.type) {\n\t\t\t\t\t\t\t//@ts-expect-error\n\t\t\t\t\t\t\tcase \"int\":\n\t\t\t\t\t\t\t\toffset = sym.content;\n\t\t\t\t\t\t\t\tconst prev = sym;\n\t\t\t\t\t\t\t\tsym = getNextSymbol();\n\t\t\t\t\t\t\t\tif (!sym) {\n\t\t\t\t\t\t\t\t\tif (prev.content > 2047n || prev.content < -2048n) {\n\t\t\t\t\t\t\t\t\t\tif (load !== false) {\n\t\t\t\t\t\t\t\t\t\t\tif (prev.content !== (prev.content & 0xffffffffn)) {\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tplaceData({\n\t\t\t\t\t\t\t\t\t\t\t\ttype: \"instruction\",\n\t\t\t\t\t\t\t\t\t\t\t\tcontent:\n\t\t\t\t\t\t\t\t\t\t\t\t\t0b0110111 |\n\t\t\t\t\t\t\t\t\t\t\t\t\t(load << 7) |\n\t\t\t\t\t\t\t\t\t\t\t\t\t((Number(prev.content & 0xffffffffn) >> 12) << 12),\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\t\t\t\treg: load,\n\t\t\t\t\t\t\t\t\t\t\t\toffset: Number(offset) & 0xfff,\n\t\t\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tthrow new AssemblError(\n\t\t\t\t\t\t\t\t\t\t\t\tI18n.errors.OutOfBountsOff12bit(i + 1 + \"\", prev.content + \"\"),\n\t\t\t\t\t\t\t\t\t\t\t\ti,\n\t\t\t\t\t\t\t\t\t\t\t\tfile,\n\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\t\treg: 0,\n\t\t\t\t\t\t\t\t\t\toffset: Number(offset) & 0xfff,\n\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t} else if (sym.type == \"parentheses\") {\n\t\t\t\t\t\t\t\t\t//fall\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tthrow new AssemblError(I18n.errors.expectOffreg(i + 1 + \"\"), i, file);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tcase \"parentheses\":\n\t\t\t\t\t\t\t\tif (sym.contains.length > 1) {\n\t\t\t\t\t\t\t\t\tthrow new AssemblError(I18n.errors.TooManyPars(i + 1 + \"\"), i, file);\n\t\t\t\t\t\t\t\t} else if (sym.contains.length === 0) {\n\t\t\t\t\t\t\t\t\tthrow new AssemblError(I18n.errors.TooFewPars(i + 1 + \"\"), i, file);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (sym.contains[0].type !== \"register\") {\n\t\t\t\t\t\t\t\t\tthrow new AssemblError(I18n.errors.expectOffreg(i + 1 + \"\"), i, file);\n\t\t\t\t\t\t\t\t} else if (sym.contains[0].floating) {\n\t\t\t\t\t\t\t\t\tthrow new AssemblError(I18n.errors.expectIntReg(i + 1 + \"\"), i, file);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\treg: sym.contains[0].number,\n\t\t\t\t\t\t\t\t\toffset: Number(offset) & 0xfff,\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tcase \"unknown\":\n\t\t\t\t\t\t\t\tif (load === false) {\n\t\t\t\t\t\t\t\t\tconst sym = getNextSymbol();\n\t\t\t\t\t\t\t\t\tif (!sym)\n\t\t\t\t\t\t\t\t\t\tthrow new AssemblError(\n\t\t\t\t\t\t\t\t\t\t\tI18n.errors.InstructionNeededMoreParams(i + 1 + \"\"),\n\t\t\t\t\t\t\t\t\t\t\ti,\n\t\t\t\t\t\t\t\t\t\t\tfile,\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\tif (sym.type !== \"register\") {\n\t\t\t\t\t\t\t\t\t\tthrow new AssemblError(I18n.errors.expectedRegi(i + 1 + \"\"), i, file);\n\t\t\t\t\t\t\t\t\t} else if (sym.floating) {\n\t\t\t\t\t\t\t\t\t\tthrow new AssemblError(I18n.errors.expectIntReg(i + 1 + \"\"), i, file);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tload = sym.number;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tplaceData({\n\t\t\t\t\t\t\t\t\ttype: \"instruction\",\n\t\t\t\t\t\t\t\t\tcontent: 0b0010111 | (load << 7),\n\t\t\t\t\t\t\t\t\tlink: {type: \"AU\", label: sym.content},\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tdataLables.set(getCurAddress(), {\n\t\t\t\t\t\t\t\t\tlabel: sym.content,\n\t\t\t\t\t\t\t\t\ttype: (\"R\" + type) as \"RI\" | \"RS\",\n\t\t\t\t\t\t\t\t\tline: i,\n\t\t\t\t\t\t\t\t\tfile,\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\treg: load,\n\t\t\t\t\t\t\t\t\toffset: 0,\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\tthrow new AssemblError(I18n.errors.expectOffreg(i + 1 + \"\"), i, file);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tfunction getLabel() {\n\t\t\t\t\t\tconst sym = getNextSymbol();\n\t\t\t\t\t\tif (!sym)\n\t\t\t\t\t\t\tthrow new AssemblError(I18n.errors.InstructionNeededMoreParams(i + 1 + \"\"), i, file);\n\t\t\t\t\t\tif (sym.type !== \"unknown\")\n\t\t\t\t\t\t\tthrow new AssemblError(I18n.errors.expectedLabel(i + 1 + \"\"), i, file);\n\t\t\t\t\t\treturn sym.content;\n\t\t\t\t\t}\n\t\t\t\t\tfunction assertClear() {\n\t\t\t\t\t\tconst sym = getNextSymbol();\n\t\t\t\t\t\tif (sym) throw new AssemblError(I18n.errors.tooManyArguments(i + 1 + \"\"), i, file);\n\t\t\t\t\t}\n\t\t\t\t\tconst info = instMap.get(data.content);\n\t\t\t\t\tif (!info) throw new AssemblError(\"internal error fix me\", i, file);\n\n\t\t\t\t\tswitch (info.type) {\n\t\t\t\t\t\tcase \"R\": {\n\t\t\t\t\t\t\tconst lay =\n\t\t\t\t\t\t\t\tinfo.opcode |\n\t\t\t\t\t\t\t\t(getRegi(info.args[0] === \"freg\") << 7) |\n\t\t\t\t\t\t\t\t(info.funct3 << 12) |\n\t\t\t\t\t\t\t\t(getRegi(info.args[1] === \"freg\") << 15) |\n\t\t\t\t\t\t\t\t(info.funct7 << 25) |\n\t\t\t\t\t\t\t\t(getRegi(info.args[2] === \"freg\") << 20);\n\t\t\t\t\t\t\tassertClear();\n\t\t\t\t\t\t\tplaceData({type: \"instruction\", content: lay});\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcase \"I\": {\n\t\t\t\t\t\t\tif (info.args[1] === \"offreg\") {\n\t\t\t\t\t\t\t\tconst reg = getRegi(info.args[0] === \"freg\");\n\t\t\t\t\t\t\t\tconst off = getOffReg(\"I\", reg);\n\t\t\t\t\t\t\t\tconst lay =\n\t\t\t\t\t\t\t\t\tinfo.opcode |\n\t\t\t\t\t\t\t\t\t(reg << 7) |\n\t\t\t\t\t\t\t\t\t(info.funct3 << 12) |\n\t\t\t\t\t\t\t\t\t(off.reg << 15) |\n\t\t\t\t\t\t\t\t\t(off.offset << 20);\n\t\t\t\t\t\t\t\tplaceData({type: \"instruction\", content: lay});\n\t\t\t\t\t\t\t} else if (info.pimm !== undefined) {\n\t\t\t\t\t\t\t\tconst lay =\n\t\t\t\t\t\t\t\t\tinfo.opcode |\n\t\t\t\t\t\t\t\t\t(getRegi(info.args[0] === \"freg\") << 7) |\n\t\t\t\t\t\t\t\t\t(info.funct3 << 12) |\n\t\t\t\t\t\t\t\t\t(getRegi(info.args[1] === \"freg\") << 15) |\n\t\t\t\t\t\t\t\t\t(get5Bit() << 20) |\n\t\t\t\t\t\t\t\t\t(info.pimm << 25);\n\n\t\t\t\t\t\t\t\tplaceData({type: \"instruction\", content: lay});\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tconst lay =\n\t\t\t\t\t\t\t\t\tinfo.opcode |\n\t\t\t\t\t\t\t\t\t(getRegi(info.args[0] === \"freg\") << 7) |\n\t\t\t\t\t\t\t\t\t(info.funct3 << 12) |\n\t\t\t\t\t\t\t\t\t(getRegi(info.args[1] === \"freg\") << 15) |\n\t\t\t\t\t\t\t\t\t(get12Bit() << 20);\n\n\t\t\t\t\t\t\t\tplaceData({type: \"instruction\", content: lay});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tassertClear();\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcase \"S\": {\n\t\t\t\t\t\t\tconst reg = getRegi(info.args[0] === \"freg\");\n\t\t\t\t\t\t\tconst off = getOffReg(\"S\", reg);\n\t\t\t\t\t\t\tconst lay =\n\t\t\t\t\t\t\t\tinfo.opcode |\n\t\t\t\t\t\t\t\t((off.offset & 0b11111) << 7) |\n\t\t\t\t\t\t\t\t(info.funct3 << 12) |\n\t\t\t\t\t\t\t\t(off.reg << 15) |\n\t\t\t\t\t\t\t\t(reg << 20) |\n\t\t\t\t\t\t\t\t((off.offset >> 5) << 25);\n\t\t\t\t\t\t\tplaceData({type: \"instruction\", content: lay});\n\t\t\t\t\t\t\tassertClear();\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcase \"B\": {\n\t\t\t\t\t\t\tconst lay =\n\t\t\t\t\t\t\t\tinfo.opcode |\n\t\t\t\t\t\t\t\t(info.funct3 << 12) |\n\t\t\t\t\t\t\t\t(getRegi(info.args[0] === \"freg\") << 15) |\n\t\t\t\t\t\t\t\t(getRegi(info.args[1] === \"freg\") << 20);\n\t\t\t\t\t\t\tplaceData({\n\t\t\t\t\t\t\t\ttype: \"instruction\",\n\t\t\t\t\t\t\t\tcontent: lay,\n\t\t\t\t\t\t\t\tlink: {\n\t\t\t\t\t\t\t\t\ttype: \"B\",\n\t\t\t\t\t\t\t\t\tlabel: getLabel(),\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tassertClear();\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcase \"J\": {\n\t\t\t\t\t\t\tconst lay = info.opcode | (getRegi() << 7);\n\t\t\t\t\t\t\tplaceData({\n\t\t\t\t\t\t\t\ttype: \"instruction\",\n\t\t\t\t\t\t\t\tcontent: lay,\n\t\t\t\t\t\t\t\tlink: {\n\t\t\t\t\t\t\t\t\ttype: \"J\",\n\t\t\t\t\t\t\t\t\tlabel: getLabel(),\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tassertClear();\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcase \"U\": {\n\t\t\t\t\t\t\tlet lay = info.opcode | (getRegi(info.args[0] === \"freg\") << 7);\n\t\t\t\t\t\t\tlet next = getNextSymbol();\n\t\t\t\t\t\t\tif (!next)\n\t\t\t\t\t\t\t\tthrow new AssemblError(\n\t\t\t\t\t\t\t\t\tI18n.errors.InstructionNeededMoreParams(i + 1 + \"\"),\n\t\t\t\t\t\t\t\t\ti,\n\t\t\t\t\t\t\t\t\tfile,\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tif (next.type === \"variable\" || next.type == \"unknown\") {\n\t\t\t\t\t\t\t\tif (next.type === \"variable\") {\n\t\t\t\t\t\t\t\t\tnext = getNextSymbol();\n\t\t\t\t\t\t\t\t\tif (!next)\n\t\t\t\t\t\t\t\t\t\tthrow new AssemblError(\n\t\t\t\t\t\t\t\t\t\t\tI18n.errors.InstructionNeededMoreParams(i + 1 + \"\"),\n\t\t\t\t\t\t\t\t\t\t\ti,\n\t\t\t\t\t\t\t\t\t\t\tfile,\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\tif (next.type !== \"parentheses\")\n\t\t\t\t\t\t\t\t\t\tthrow new AssemblError(I18n.errors.expectedLabelPars(i + 1 + \"\"), i, file);\n\t\t\t\t\t\t\t\t\tif (next.contains.length > 1)\n\t\t\t\t\t\t\t\t\t\tthrow new AssemblError(I18n.errors.TooManyPars(i + 1 + \"\"), i, file);\n\t\t\t\t\t\t\t\t\tif (next.contains.length < 1)\n\t\t\t\t\t\t\t\t\t\tthrow new AssemblError(I18n.errors.TooFewPars(i + 1 + \"\"), i, file);\n\t\t\t\t\t\t\t\t\tnext = next.contains[0];\n\t\t\t\t\t\t\t\t\tif (next.type !== \"unknown\")\n\t\t\t\t\t\t\t\t\t\tthrow new AssemblError(I18n.errors.expectedLabel(i + 1 + \"\"), i, file);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tplaceData({\n\t\t\t\t\t\t\t\t\ttype: \"instruction\",\n\t\t\t\t\t\t\t\t\tcontent: lay,\n\t\t\t\t\t\t\t\t\tlink: {\n\t\t\t\t\t\t\t\t\t\ttype: info.name === \"auipc\" ? \"AU\" : \"U\",\n\t\t\t\t\t\t\t\t\t\tlabel: next.content,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t} else if (next.type === \"int\") {\n\t\t\t\t\t\t\t\tif (next.content < -524288n || next.content > 524287n) {\n\t\t\t\t\t\t\t\t\tthrow new AssemblError(I18n.errors.OutOfBounts20bit(i + 1 + \"\"), i, file);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tlay = lay | (Number(next.content) << 12);\n\t\t\t\t\t\t\t\tplaceData({\n\t\t\t\t\t\t\t\t\ttype: \"instruction\",\n\t\t\t\t\t\t\t\t\tcontent: lay,\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthrow new AssemblError(I18n.errors.UErrorType2(i + 1 + \"\"), i, file);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tassertClear();\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcase \"W\": {\n\t\t\t\t\t\t\tplaceData({type: \"instruction\", content: info.code});\n\t\t\t\t\t\t\tassertClear();\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcase \"fake\": {\n\t\t\t\t\t\t\tconst macro = fakeMap.get(info.name);\n\t\t\t\t\t\t\tif (macro) {\n\t\t\t\t\t\t\t\tconst argBuild: symbolType[] = [];\n\t\t\t\t\t\t\t\tlet thing = getNextSymbol();\n\n\t\t\t\t\t\t\t\twhile (thing) {\n\t\t\t\t\t\t\t\t\targBuild.push(thing);\n\t\t\t\t\t\t\t\t\tthing = getNextSymbol();\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tif (argBuild.length !== macro.args.length) {\n\t\t\t\t\t\t\t\t\tif (argBuild.length > macro.args.length) {\n\t\t\t\t\t\t\t\t\t\tthrow new AssemblError(\n\t\t\t\t\t\t\t\t\t\t\tI18n.errors.tooManyArguments(\n\t\t\t\t\t\t\t\t\t\t\t\ti + 1 + \"\",\n\t\t\t\t\t\t\t\t\t\t\t\tmacro.args.length + \"\",\n\t\t\t\t\t\t\t\t\t\t\t\targBuild.length + \"\",\n\t\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t\t\ti,\n\t\t\t\t\t\t\t\t\t\t\tfile,\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tthrow new AssemblError(\n\t\t\t\t\t\t\t\t\t\t\tI18n.errors.TooFewPars(\n\t\t\t\t\t\t\t\t\t\t\t\ti + 1 + \"\",\n\t\t\t\t\t\t\t\t\t\t\t\tmacro.args.length + \"\",\n\t\t\t\t\t\t\t\t\t\t\t\targBuild.length + \"\",\n\t\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t\t\ti,\n\t\t\t\t\t\t\t\t\t\t\tfile,\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tconst argMap = new Map(\n\t\t\t\t\t\t\t\t\targBuild.map((_, index) => {\n\t\t\t\t\t\t\t\t\t\treturn [macro.args[index], _];\n\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tconst sdirective = directive;\n\t\t\t\t\t\t\t\tconst splace = place;\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\tassembleParsed(\n\t\t\t\t\t\t\t\t\t\tmacro.lines,\n\t\t\t\t\t\t\t\t\t\tnew Map(dataLables),\n\t\t\t\t\t\t\t\t\t\tnew Map(labelMap),\n\t\t\t\t\t\t\t\t\t\targMap,\n\t\t\t\t\t\t\t\t\t\tnew Map(macros),\n\t\t\t\t\t\t\t\t\t\tmacro.line,\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\t\t\tif (e instanceof AssemblError) {\n\t\t\t\t\t\t\t\t\t\te.addTrace(i, file);\n\t\t\t\t\t\t\t\t\t\tthrow e;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tthrow e;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tdirective = sdirective;\n\t\t\t\t\t\t\t\tplace = splace;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthrow new AssemblError(\"internal error, please fix\", NaN, file);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcase \"reallyfake\": {\n\t\t\t\t\t\t\tswitch (info.name) {\n\t\t\t\t\t\t\t\tcase \"la\": {\n\t\t\t\t\t\t\t\t\tconst reg = getRegi();\n\t\t\t\t\t\t\t\t\tconst label = getLabel();\n\t\t\t\t\t\t\t\t\tassertClear();\n\t\t\t\t\t\t\t\t\tplaceData({\n\t\t\t\t\t\t\t\t\t\ttype: \"instruction\",\n\t\t\t\t\t\t\t\t\t\tcontent: 0b0010111 | (reg << 7),\n\t\t\t\t\t\t\t\t\t\tlink: {type: \"AU\", label},\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tplaceData({\n\t\t\t\t\t\t\t\t\t\ttype: \"instruction\",\n\t\t\t\t\t\t\t\t\t\tcontent: 0b0010011 | (reg << 7) | (reg << 15),\n\t\t\t\t\t\t\t\t\t\tlink: {type: \"RI\", label},\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tcase \"li\": {\n\t\t\t\t\t\t\t\t\tconst reg = getRegi();\n\t\t\t\t\t\t\t\t\tconst numb = getNumb();\n\t\t\t\t\t\t\t\t\tassertClear();\n\t\t\t\t\t\t\t\t\tif (numb <= 2047n && numb >= -2048) {\n\t\t\t\t\t\t\t\t\t\tplaceData({\n\t\t\t\t\t\t\t\t\t\t\ttype: \"instruction\",\n\t\t\t\t\t\t\t\t\t\t\tcontent: 0b0010011 | (reg << 7) | (Number(numb) << 20),\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t} else if (numb <= 2147483647n && numb >= -2147483648) {\n\t\t\t\t\t\t\t\t\t\tconst low = Number(numb) & 0xfff;\n\t\t\t\t\t\t\t\t\t\tplaceData({\n\t\t\t\t\t\t\t\t\t\t\ttype: \"instruction\",\n\t\t\t\t\t\t\t\t\t\t\tcontent:\n\t\t\t\t\t\t\t\t\t\t\t\t0b0110111 |\n\t\t\t\t\t\t\t\t\t\t\t\t(reg << 7) |\n\t\t\t\t\t\t\t\t\t\t\t\t(Number(numb + (low > 2047 ? 2048 : 0)) & 0xfffff000),\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\tplaceData({\n\t\t\t\t\t\t\t\t\t\t\ttype: \"instruction\",\n\t\t\t\t\t\t\t\t\t\t\tcontent: 0b0011011 | (reg << 7) | (reg << 15) | (low << 20),\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\twhile (true) {\n\t\t\t\t\tconst sym = getNextSymbol();\n\t\t\t\t\tif (!sym) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tswitch (sym.type) {\n\t\t\t\t\t\t//@ts-expect-error\n\t\t\t\t\t\tcase \"unknown\":\n\t\t\t\t\t\t\tconst macro = macros.get(sym.content);\n\t\t\t\t\t\t\tif (macro) {\n\t\t\t\t\t\t\t\tlet argBuild: symbolType[] = [];\n\t\t\t\t\t\t\t\tlet thing = getNextSymbol();\n\t\t\t\t\t\t\t\tif (thing) {\n\t\t\t\t\t\t\t\t\tif (thing.type === \"parentheses\") {\n\t\t\t\t\t\t\t\t\t\targBuild = thing.contains;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\twhile (thing) {\n\t\t\t\t\t\t\t\t\t\t\targBuild.push(thing);\n\t\t\t\t\t\t\t\t\t\t\tthing = getNextSymbol();\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (argBuild.length !== macro.args.length) {\n\t\t\t\t\t\t\t\t\tif (argBuild.length > macro.args.length) {\n\t\t\t\t\t\t\t\t\t\tthrow new AssemblError(\n\t\t\t\t\t\t\t\t\t\t\tI18n.errors.tooManyArgumentsMacro(\n\t\t\t\t\t\t\t\t\t\t\t\ti + 1 + \"\",\n\t\t\t\t\t\t\t\t\t\t\t\tmacro.args.length + \"\",\n\t\t\t\t\t\t\t\t\t\t\t\targBuild.length + \"\",\n\t\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t\t\ti,\n\t\t\t\t\t\t\t\t\t\t\tfile,\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tthrow new AssemblError(\n\t\t\t\t\t\t\t\t\t\t\tI18n.errors.tooFewArgumentsMacro(\n\t\t\t\t\t\t\t\t\t\t\t\ti + 1 + \"\",\n\t\t\t\t\t\t\t\t\t\t\t\tmacro.args.length + \"\",\n\t\t\t\t\t\t\t\t\t\t\t\targBuild.length + \"\",\n\t\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t\t\ti,\n\t\t\t\t\t\t\t\t\t\t\tfile,\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tconst argMap = new Map(\n\t\t\t\t\t\t\t\t\targBuild.map((_, index) => {\n\t\t\t\t\t\t\t\t\t\treturn [macro.args[index], _];\n\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tconst sdirective = directive;\n\t\t\t\t\t\t\t\tconst splace = place;\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\tassembleParsed(\n\t\t\t\t\t\t\t\t\t\tmacro.lines,\n\t\t\t\t\t\t\t\t\t\tnew Map(dataLables),\n\t\t\t\t\t\t\t\t\t\tnew Map(labelMap),\n\t\t\t\t\t\t\t\t\t\targMap,\n\t\t\t\t\t\t\t\t\t\tnew Map(macros),\n\t\t\t\t\t\t\t\t\t\tmacro.line,\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\t\t\tif (e instanceof AssemblError) {\n\t\t\t\t\t\t\t\t\t\te.addTrace(i, file);\n\t\t\t\t\t\t\t\t\t\tthrow e;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tthrow e;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tdirective = sdirective;\n\t\t\t\t\t\t\t\tplace = splace;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\tcase \"int\":\n\t\t\t\t\t\tcase \"float\":\n\t\t\t\t\t\tcase \"string\":\n\t\t\t\t\t\t\tplaceData(sym);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"label\":\n\t\t\t\t\t\t\t//TODO check for conflicts\n\t\t\t\t\t\t\tlabelMap.set(sym.content, getCurAddress());\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"register\":\n\t\t\t\t\t\t\tthrow new AssemblError(I18n.errors.loneRegister(i + 1 + \"\"), i, file);\n\t\t\t\t\t\tcase \"variable\":\n\t\t\t\t\t\t\tthrow new AssemblError(I18n.errors.varOutsideMacro(i + 1 + \"\"), i, file);\n\t\t\t\t\t\tcase \"parentheses\":\n\t\t\t\t\t\t\tthrow new AssemblError(I18n.errors.parenthesesWeird(i + 1 + \"\"), i, file);\n\t\t\t\t\t\tcase \"directive\":\n\t\t\t\t\t\t\thandleDirrective(sym);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"instruction\":\n\t\t\t\t\t\t\thandleInstruction(sym);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t//@ts-expect-error\n\t\t\t\t\t\t\tconsole.error(sym.type, \"not handled\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ti++;\n\t\t\t}\n\t\t\tfor (const [thing, line] of globalLabelSet) {\n\t\t\t\tconst label = labelMap.get(thing);\n\t\t\t\tif (!label) {\n\t\t\t\t\tthrow new AssemblError(I18n.errors.unmatchedLabel(line + 1 + \"\", thing), line, file);\n\t\t\t\t}\n\t\t\t\tglobalLabelMap.set(thing, label);\n\t\t\t}\n\t\t\tlink(labelMap, dataLables);\n\t\t}\n\t\tassembleParsed(basicParsing);\n\t}\n\tconst ram = link(globalLabelMap, globalDataLabels, true);\n\tconst main = globalLabelMap.get(\"main\");\n\treturn [ram, main || 0x00400000] as [Ram, number];\n}\nexport {assemble, AssemblError};\n"],"names":["Ram","I18n","parseLine","instructions","registerNames","regNames","Map","int","map","_","i","type","number","floating","flat","float","instMap","name","fakeMap","filter","inst","args","lines","replace","split","line","NaN","AssemblError","Error","file","trace","constructor","reason","addTrace","push","assemble","files","textView","DataView","ArrayBuffer","textIndex","dataView","dataIndex","globalDataLabels","globalLabelMap","link","labelMap","dataLables","globalRun","ram","address","thing","label","get","errors","unmatchedLabel","set","setInt8","setInt16","setInt32","setBigInt64","getInt32","offset","evilJump","evil","console","log","toString","padStart","code","getCurAddress","place","basicParsing","directive","globalLabelSet","Set","assembleParsed","varMap","macros","macroBuild","placeData","data","dataInText","content","JSON","stringify","notAString","encode","TextEncoder","char","setUint8","stringOutsideOfDirrective","setFloat32","setFloat64","wrongDirrectiveFloat","Number","setUint16","setUint32","setBigUint64","lableCantFloat","s","lineArr","length","undefined","handleDirrective","dataDirectiveInText","getNextSymbol","expectGlobal","expectedLabel","add","macroName","params","macroArgs","contains","unknownDirective","helperNext","itterate","helper","symbol","invalidString","invalidChar","CharTooLong","innards","ParNoMatch","next","pop","shift","str","parse","join","BigInt","arr","reg","mapped","handleInstruction","get12Bit","sym","InstructionNeededMoreParams","expectedInt","OutOfBounts12bit","getNumb","get5Bit","OutOfBounds5bit","getRegi","expectedRegi","expectIntReg","expectFloatReg","getOffReg","load","prev","OutOfBountsOff12bit","expectOffreg","TooManyPars","TooFewPars","getLabel","assertClear","tooManyArguments","info","lay","opcode","funct3","funct7","off","pimm","expectedLabelPars","OutOfBounts20bit","UErrorType2","macro","argBuild","argMap","index","sdirective","splace","e","numb","low","tooManyArgumentsMacro","tooFewArgumentsMacro","loneRegister","varOutsideMacro","parenthesesWeird","error","main"],"mappings":"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"}