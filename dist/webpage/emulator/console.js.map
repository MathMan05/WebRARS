{"version":3,"sources":["../../../src/webpage/emulator/console.ts"],"sourcesContent":["import {I18n} from \"../i18n.js\";\n\nclass Console {\n\tconstructor() {}\n\tconsoleArea?: HTMLPreElement;\n\tmessages: (string | [\"urgent\", string])[] = [];\n\tio: (string | [\"urgent\", string])[] = [];\n\ttab: \"messages\" | \"io\" = \"io\";\n\tmakeHtml() {\n\t\tconst div = document.createElement(\"div\");\n\t\tdiv.classList.add(\"flexttb\");\n\n\t\tconst tabs = document.createElement(\"div\");\n\t\ttabs.classList.add(\"flexltr\", \"tabStyle\");\n\t\tdiv.append(tabs);\n\n\t\tconst container = document.createElement(\"div\");\n\t\tcontainer.classList.add(\"flexltr\", \"consoleContainer\");\n\t\tdiv.append(container);\n\n\t\tconst clear = document.createElement(\"button\");\n\t\tclear.textContent = I18n.Clear();\n\t\tcontainer.append(clear);\n\t\tthis.clearB = clear;\n\n\t\tconst consoleArea = document.createElement(\"pre\");\n\t\tcontainer.append(consoleArea);\n\t\tthis.consoleArea = consoleArea;\n\n\t\tconst messages = document.createElement(\"button\");\n\t\tmessages.textContent = I18n.Messages();\n\t\ttabs.append(messages);\n\t\tthis.mButton = messages;\n\t\tmessages.onclick = () => {\n\t\t\tthis.messageBClick();\n\t\t};\n\n\t\tthis.iButton = document.createElement(\"button\");\n\t\tthis.iButton.textContent = I18n.runio();\n\t\ttabs.append(this.iButton);\n\t\tthis.iButton.onclick = () => {\n\t\t\tthis.messageIClick();\n\t\t};\n\t\tmessages.click();\n\t\treturn div;\n\t}\n\tmButton?: HTMLButtonElement;\n\tiButton?: HTMLButtonElement;\n\tclearB?: HTMLButtonElement;\n\tmessageIClick() {\n\t\tif (this.tab === \"io\") return;\n\t\tif (!this.consoleArea) return;\n\t\tconst consoleArea = this.consoleArea;\n\t\tif (!this.mButton) return;\n\t\tif (!this.clearB) return;\n\t\tif (!this.iButton) return;\n\t\tconsoleArea.innerHTML = \"\";\n\t\tthis.iButton.classList.add(\"selected\");\n\t\tthis.mButton.classList.remove(\"selected\");\n\t\tthis.tab = \"io\";\n\t\tfor (const m of this.io) {\n\t\t\tthis.publishIO(m);\n\t\t}\n\t\tthis.clearB.onclick = () => {\n\t\t\tthis.io = [];\n\t\t\tconsoleArea.innerHTML = \"\";\n\t\t};\n\t}\n\tmessageBClick() {\n\t\tif (this.tab === \"messages\") return;\n\t\tif (!this.consoleArea) return;\n\t\tconst consoleArea = this.consoleArea;\n\t\tif (!this.mButton) return;\n\t\tif (!this.clearB) return;\n\t\tif (!this.iButton) return;\n\t\tconsoleArea.innerHTML = \"\";\n\t\tthis.mButton.classList.add(\"selected\");\n\t\tthis.iButton.classList.remove(\"selected\");\n\t\tthis.tab = \"messages\";\n\t\tfor (const m of this.messages) {\n\t\t\tthis.publishMessage(m);\n\t\t}\n\t\tthis.clearB.onclick = () => {\n\t\t\tthis.messages = [];\n\t\t\tconsoleArea.innerHTML = \"\";\n\t\t};\n\t}\n\tpublishIO(m: string | string[]) {\n\t\tif (this.tab !== \"io\") return;\n\t\tif (!this.consoleArea) return;\n\t\tif (m instanceof Array) {\n\t\t\tconst b = document.createElement(\"b\");\n\t\t\tb.textContent = m[1];\n\t\t\tthis.consoleArea.prepend(b, document.createElement(\"br\"));\n\t\t} else {\n\t\t\tconst lines = m.split(\"\\n\");\n\n\t\t\tconst child = this.consoleArea.children[0];\n\t\t\tif (child instanceof HTMLSpanElement) {\n\t\t\t\tchild.textContent ||= \"\";\n\t\t\t\tchild.textContent += lines.shift();\n\t\t\t}\n\t\t\tfor (const line of lines) {\n\t\t\t\tconst span = document.createElement(\"span\");\n\t\t\t\tspan.textContent = line;\n\t\t\t\tthis.consoleArea.prepend(span);\n\t\t\t}\n\t\t}\n\t}\n\taddIO(content: string, urgent = false) {\n\t\tif (urgent) {\n\t\t\tthis.messageIClick();\n\t\t\tthis.io.push([\"urgent\", content]);\n\t\t\tthis.publishIO([\"urgent\", content]);\n\t\t} else {\n\t\t\tthis.io.push(content);\n\t\t\tthis.publishIO(content);\n\t\t}\n\t}\n\tpublishMessage(m: string | string[]) {\n\t\tif (this.tab !== \"messages\") return;\n\t\tif (!this.consoleArea) return;\n\t\tif (m instanceof Array) {\n\t\t\tconst b = document.createElement(\"b\");\n\t\t\tb.textContent = m[1];\n\t\t\tthis.consoleArea.prepend(b, document.createElement(\"br\"));\n\t\t} else {\n\t\t\tconst lines = m.split(\"\\n\");\n\t\t\tconst child = this.consoleArea.children[0];\n\t\t\tif (child instanceof HTMLSpanElement) {\n\t\t\t\tchild.textContent ||= \"\";\n\t\t\t\tchild.textContent += lines.shift();\n\t\t\t}\n\t\t\tfor (const line of lines) {\n\t\t\t\tconst span = document.createElement(\"span\");\n\t\t\t\tspan.textContent = line;\n\t\t\t\tthis.consoleArea.prepend(span);\n\t\t\t}\n\t\t}\n\t}\n\taddMessage(content: string, urgent = false) {\n\t\tif (urgent) {\n\t\t\tthis.messageBClick();\n\t\t\tthis.messages.push([\"urgent\", content]);\n\t\t\tthis.publishMessage([\"urgent\", content]);\n\t\t} else {\n\t\t\tthis.messages.push(content);\n\t\t\tthis.publishMessage(content);\n\t\t}\n\t}\n}\nexport {Console};\n"],"names":["I18n","Console","constructor","consoleArea","messages","io","tab","makeHtml","div","document","createElement","classList","add","tabs","append","container","clear","textContent","Clear","clearB","Messages","mButton","onclick","messageBClick","iButton","runio","messageIClick","click","innerHTML","remove","m","publishIO","publishMessage","Array","b","prepend","lines","split","child","children","HTMLSpanElement","shift","line","span","addIO","content","urgent","push","addMessage"],"mappings":"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"}