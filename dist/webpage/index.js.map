{"version":3,"sources":["../../src/webpage/index.ts"],"sourcesContent":["import {AssemblError} from \"./assembler/assembler.js\";\nimport {Contextmenu} from \"./contextMenu.js\";\nimport {Editor} from \"./editor/editor.js\";\nimport {Console} from \"./emulator/console.js\";\nimport {Etab} from \"./executeTab/etab.js\";\nimport {I18n} from \"./i18n.js\";\nimport {Project} from \"./projects/project.js\";\nimport {ProjFiles} from \"./projects/projectFiles.js\";\nconst actionRow = document.getElementById(\"actionRow\");\nif (!actionRow) throw Error(\"action row not in document\");\nconst cons = new Console();\n//Waiting for the translations to load\nawait I18n.done;\nconst fileMenu = new Contextmenu(\"File\");\nfileMenu.addButton(\n\t() => I18n.file.new(),\n\t() => {\n\t\tnewFile.click();\n\t},\n);\nfileMenu.addButton(\n\t() => I18n.file.open(),\n\t() => {\n\t\topenNewFile();\n\t},\n);\nfileMenu.addButton(\n\t() => I18n.file.save(),\n\t() => {\n\t\tfocusedEditor.save();\n\t},\n);\nfileMenu.addButton(\n\t() => I18n.file.saveAll(),\n\t() => {\n\t\teditors.map((_) => _.save());\n\t},\n);\nfileMenu.addButton(\n\t() => I18n.file.saveAs(),\n\t() => {\n\t\tdownloadEditor(focusedEditor);\n\t},\n);\n\nconst fileButton = document.createElement(\"button\");\nfileButton.textContent = I18n.file.file();\nactionRow.append(fileButton);\nfileMenu.bindContextmenu(fileButton, undefined, undefined, true);\n\nconst menu = new Contextmenu(\"run\");\n\nconst assemble = document.getElementById(\"assemble\") as HTMLElement;\nmenu.addButton(\n\t() => I18n.run.assemble(),\n\t() => {\n\t\tassemble.click();\n\t},\n\t{\n\t\tenabled: () => !assemble.classList.contains(\"disabled\"),\n\t},\n);\n\nconst start = document.getElementById(\"start\") as HTMLElement;\nmenu.addButton(\n\t() => I18n.run.run(),\n\t() => {\n\t\tstart.click();\n\t},\n\t{\n\t\tenabled: () => !start.classList.contains(\"disabled\"),\n\t},\n);\n\nconst step = document.getElementById(\"step\") as HTMLElement;\nmenu.addButton(\n\t() => I18n.run.step(),\n\t() => {\n\t\tstep.click();\n\t},\n\t{\n\t\tenabled: () => !step.classList.contains(\"disabled\"),\n\t},\n);\n\nconst backStep = document.getElementById(\"backStep\") as HTMLElement;\nmenu.addButton(\n\t() => I18n.run.backStep(),\n\t() => {\n\t\tbackStep.click();\n\t},\n\t{\n\t\tenabled: () => !backStep.classList.contains(\"disabled\"),\n\t},\n);\n\nconst reset = document.getElementById(\"reset\") as HTMLElement;\nmenu.addButton(\n\t() => I18n.run.reset(),\n\t() => {\n\t\treset.click();\n\t},\n\t{\n\t\tenabled: () => !reset.classList.contains(\"disabled\"),\n\t},\n);\n\nconst runButton = document.createElement(\"button\");\nrunButton.textContent = I18n.run.run();\nactionRow.append(runButton);\nmenu.bindContextmenu(runButton, undefined, undefined, true);\n\nconst area = document.getElementById(\"area\") as HTMLElement;\nif (!area) throw Error(\"area not found\");\nlet editors: Editor[] = [];\n\nlet focusedEditor = editors[0];\n\nconst newFile = document.getElementById(\"newFile\") as HTMLImageElement;\nnewFile.onclick = () => {\n\tsystem.disable();\n\tconst editor = new Editor(\"\", `riscv${editors.length + 1}.asm`, cons, curProject?.dir);\n\tif (curProject) {\n\t\tEditor.editMap.set(`${curProject.name}:/${editor.fileName}`, editor);\n\t\teditor.fileDir = `${curProject.name}:/${editor.fileName}`;\n\t}\n\teditors.push(editor);\n\tfocusedEditor = editor;\n\teditArea();\n\tif (curProject) {\n\t\tsetTimeout(() => editor.save(), 100);\n\t}\n};\n\nassemble.onclick = () => {\n\tfocusedEditor.assemble();\n};\n\nconst editButton = document.getElementById(\"EditButton\") as HTMLButtonElement;\nconst executeButton = document.getElementById(\"ExecuteButton\") as HTMLButtonElement;\neditButton.onclick = () => {\n\teditArea();\n};\nexecuteButton.onclick = () => {\n\texecuteArea();\n};\nlet system = new Etab();\n\nconst buttons = new Map<Editor, HTMLButtonElement>();\nconst saved = new Map<Editor, boolean>();\n\nfunction checkIfReload() {\n\tfor (const [_, bool] of saved) {\n\t\tif (!bool) {\n\t\t\twindow.onbeforeunload = () => \"true\";\n\t\t\treturn;\n\t\t}\n\t}\n\twindow.onbeforeunload = null;\n}\nlet editAreadiv = document.createElement(\"div\");\nlet selectedTab: HTMLElement;\nasync function createRegiArea() {\n\tconst regiArea = document.getElementById(\"regiArea\") as HTMLElement;\n\tif (projFile) {\n\t\tconst html = await projFile.createHTML();\n\t\tregiArea.innerHTML = \"\";\n\t\tregiArea.append(html);\n\t} else {\n\t\tregiArea.innerHTML = \"\";\n\t}\n}\nasync function editArea() {\n\tconst tabs = document.createElement(\"div\");\n\ttabs.classList.add(\"tabStyle\");\n\teditButton.classList.add(\"selected\");\n\texecuteButton.classList.remove(\"selected\");\n\tawait createRegiArea();\n\tarea.innerHTML = \"\";\n\tarea.append(tabs);\n\tif (editors.length !== 0) {\n\t\tfor (const editor of editors) {\n\t\t\tconst bu = buttons.get(editor);\n\t\t\tif (bu) {\n\t\t\t\tif (editor === focusedEditor) {\n\t\t\t\t\tbu.click();\n\t\t\t\t}\n\t\t\t\ttabs.append(bu);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tconst button = document.createElement(\"button\");\n\t\t\tbuttons.set(editor, button);\n\t\t\tbutton.textContent = editor.fileName;\n\t\t\ttabs.append(button);\n\n\t\t\tbutton.addEventListener(\"mousedown\", (e) => {\n\t\t\t\tif (e.button === 1) {\n\t\t\t\t\tconst saving = saved.get(editor);\n\t\t\t\t\tif (!saving) {\n\t\t\t\t\t\tif (!confirm(I18n.unsaved())) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbutton.remove();\n\t\t\t\t\tbuttons.delete(editor);\n\t\t\t\t\teditors = editors.filter((_) => _ != editor);\n\t\t\t\t\tif (editor.fileDir) {\n\t\t\t\t\t\tEditor.editMap.delete(editor.fileDir);\n\t\t\t\t\t}\n\t\t\t\t\tif (editor == focusedEditor) {\n\t\t\t\t\t\tfocusedEditor = editors[0];\n\t\t\t\t\t\teditArea();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tbutton.addEventListener(\"click\", () => {\n\t\t\t\tif (focusedEditor !== editor) {\n\t\t\t\t\tsystem.disable();\n\t\t\t\t}\n\t\t\t\tfocusedEditor = editor;\n\t\t\t\tif (selectedTab) {\n\t\t\t\t\tselectedTab.classList.remove(\"selected\");\n\t\t\t\t}\n\t\t\t\teditAreadiv.remove();\n\t\t\t\teditAreadiv = editor.createEditor();\n\t\t\t\tarea.append(editAreadiv);\n\t\t\t\tbutton.classList.add(\"selected\");\n\t\t\t\tselectedTab = button;\n\t\t\t});\n\t\t\teditor.addEventListener(\"Assemble\", async (e) => {\n\t\t\t\tif (e.sys instanceof AssemblError) {\n\t\t\t\t\tif (e.sys.file === (editor.fileDir || editor.fileName)) {\n\t\t\t\t\t\tbutton.click();\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\teditor.giveError(e.sys);\n\t\t\t\t\t\t} catch {\n\t\t\t\t\t\t\tconsole.error(e);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (!curProject) throw new Error(\"wow, something really broke, not sure what\");\n\t\t\t\t\t\tlet editor = Editor.editMap.get(e.sys.file);\n\t\t\t\t\t\tif (!editor) {\n\t\t\t\t\t\t\tconst file = await curProject.getFile(e.sys.file);\n\t\t\t\t\t\t\teditor = new Editor(await file.text(), file.name, cons, curProject?.dir);\n\t\t\t\t\t\t\tEditor.editMap.set(e.sys.file, editor);\n\t\t\t\t\t\t\teditor.fileDir = e.sys.file;\n\t\t\t\t\t\t\teditors.push(editor);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfocusedEditor = editor;\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\teditor.giveError(e.sys);\n\t\t\t\t\t\t} catch {\n\t\t\t\t\t\t\tconsole.error(e);\n\t\t\t\t\t\t}\n\t\t\t\t\t\teditArea();\n\t\t\t\t\t}\n\t\t\t\t\tcons.addMessage(e.sys.message, true);\n\t\t\t\t} else {\n\t\t\t\t\tsystem.handSystem(e.sys);\n\t\t\t\t\texecuteArea();\n\t\t\t\t}\n\t\t\t});\n\t\t\tsaved.set(editor, true);\n\t\t\tcheckIfReload();\n\t\t\teditor.addEventListener(\"save\", async () => {\n\t\t\t\tbutton.textContent = editor.fileName;\n\t\t\t\tsaved.set(editor, true);\n\t\t\t\tcheckIfReload();\n\t\t\t\tif (curProject) {\n\t\t\t\t\tawait curProject.saveAsm(editor.fileName, editor.string());\n\t\t\t\t\tcreateRegiArea();\n\t\t\t\t} else {\n\t\t\t\t\tdownloadEditor(editor);\n\t\t\t\t}\n\t\t\t});\n\t\t\teditor.addEventListener(\"changed\", () => {\n\t\t\t\tbutton.textContent = editor.fileName + \"*\";\n\t\t\t\tsaved.set(editor, false);\n\t\t\t\tcheckIfReload();\n\t\t\t\tsystem.disable();\n\t\t\t});\n\t\t\tif (editor === focusedEditor) {\n\t\t\t\tbutton.click();\n\t\t\t}\n\t\t}\n\t} else {\n\t\teditAreadiv.remove();\n\t\teditAreadiv = document.createElement(\"div\");\n\t\tarea.append(editAreadiv);\n\t\tconst h = document.createElement(\"h1\");\n\t\th.textContent = I18n.startScreen();\n\n\t\tconst project = document.createElement(\"button\");\n\t\tproject.textContent = I18n.startProject();\n\t\tproject.onclick = () => {\n\t\t\tnewProjectDialog();\n\t\t};\n\t\tconst file = document.createElement(\"button\");\n\t\tfile.textContent = I18n.openFile();\n\t\tfile.onclick = () => {\n\t\t\topenNewFile();\n\t\t};\n\n\t\teditAreadiv.classList.add(\"flexttb\", \"start\");\n\n\t\tconst projectList = document.createElement(\"div\");\n\t\tprojectList.classList.add(\"flexttb\", \"projectList\");\n\n\t\tconst openExisting = document.createElement(\"h4\");\n\t\topenExisting.textContent = I18n.project.openExisting();\n\n\t\t(async () => {\n\t\t\tfor await (const thing of Project.getProjects()) {\n\t\t\t\tconst button = document.createElement(\"button\");\n\t\t\t\tbutton.textContent = thing.name;\n\t\t\t\tbutton.onclick = () => {\n\t\t\t\t\topenProject(thing);\n\t\t\t\t};\n\t\t\t\tprojectList.append(button);\n\t\t\t}\n\t\t})();\n\n\t\teditAreadiv.append(h, project, file, openExisting, projectList);\n\t\tarea.append(editAreadiv);\n\t}\n}\nconst save = document.getElementById(\"save\") as HTMLElement;\nsave.onclick = () => {\n\tif (focusedEditor) {\n\t\tfocusedEditor.save();\n\t}\n};\nfunction newProjectDialog() {\n\tconst dialog = document.createElement(\"dialog\");\n\tdocument.body.append(dialog);\n\tconst p1 = document.createElement(\"h4\");\n\tp1.textContent = I18n.project.name();\n\tdialog.append(p1);\n\n\tconst input = document.createElement(\"input\");\n\tinput.type = \"text\";\n\tdialog.append(input);\n\n\tconst submit = document.createElement(\"button\");\n\tsubmit.textContent = I18n.submit();\n\tdialog.append(submit);\n\tsubmit.onclick = async () => {\n\t\tconst name = input.value;\n\t\tif (name.length === 0) {\n\t\t\talert(I18n.project.pleaseEnterName());\n\t\t\treturn;\n\t\t}\n\t\tconst proj = await Project.checkName(name);\n\t\tif (proj) {\n\t\t\tdialog.remove();\n\t\t\topenProject(proj);\n\t\t} else {\n\t\t\talert(I18n.project.nameTaken());\n\t\t\treturn;\n\t\t}\n\t};\n\n\tdialog.showModal();\n}\nfunction openNewFile() {\n\tconst input = document.createElement(\"input\");\n\tinput.type = \"file\";\n\tinput.accept = \".asm\";\n\tdocument.body.append(input);\n\tinput.click();\n\tinput.remove();\n\tinput.onchange = async () => {\n\t\tif (input.files && input.files.length) {\n\t\t\tlet newEditor: undefined | Editor;\n\n\t\t\tconst editorList = Array.from(input.files).map(async (file) => {\n\t\t\t\tconst editor = new Editor(await file.text(), file.name, cons, curProject?.dir);\n\t\t\t\tif (curProject) {\n\t\t\t\t\tEditor.editMap.set(`${curProject.name}:/${editor.fileName}`, editor);\n\t\t\t\t\teditor.fileDir = `${curProject.name}:/${editor.fileName}`;\n\t\t\t\t}\n\t\t\t\tnewEditor ||= editor;\n\t\t\t\teditors.push(editor);\n\t\t\t\treturn editor;\n\t\t\t});\n\t\t\tconst arr = await Promise.all(editorList);\n\t\t\tif (newEditor) {\n\t\t\t\tfocusedEditor = newEditor;\n\t\t\t}\n\t\t\tawait editArea();\n\n\t\t\tif (curProject) {\n\t\t\t\tsetTimeout(() => arr.forEach((e) => e.save()), 100);\n\t\t\t}\n\t\t}\n\t};\n}\nfunction downloadEditor(editor: Editor) {\n\tconst text = editor.string();\n\tconst fileName = editor.fileName;\n\tvar blob = new Blob([text]);\n\tvar a = document.createElement(\"a\");\n\ta.download = fileName;\n\ta.href = URL.createObjectURL(blob);\n\ta.dataset.downloadurl = [a.download, a.href].join(\":\");\n\ta.style.display = \"none\";\n\tdocument.body.appendChild(a);\n\ta.click();\n\tdocument.body.removeChild(a);\n\tsetTimeout(function () {\n\t\tURL.revokeObjectURL(a.href);\n\t}, 1500);\n}\nlet curProject: Project | undefined;\nlet projFile: ProjFiles | undefined;\nasync function openProject(proj: Project) {\n\tcurProject = proj;\n\tprojFile = new ProjFiles(proj);\n\tprojFile.addEventListener(\"open\", async (e) => {\n\t\tconst editor = Editor.editMap.get(`${proj.name}:${e.fileName}`);\n\t\tif (editor) {\n\t\t\tconst button = buttons.get(editor);\n\t\t\tif (button) {\n\t\t\t\tbutton.click();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tconst newEditor = new Editor(\n\t\t\tawait e.file.text(),\n\t\t\te.fileName.split(\"/\").at(-1),\n\t\t\tcons,\n\t\t\tcurProject?.dir,\n\t\t);\n\t\teditors.push(newEditor);\n\t\tfocusedEditor = newEditor;\n\t\tEditor.editMap.set(`${proj.name}:/${newEditor.fileName}`, newEditor);\n\t\tnewEditor.fileDir = `${proj.name}:/${newEditor.fileName}`;\n\t\tawait editArea();\n\t});\n\tfor await (const thing of proj.getAsm()) {\n\t\tconst editor = new Editor(await thing[1].text(), thing[0], cons, curProject?.dir);\n\t\tEditor.editMap.set(`${curProject.name}:/${editor.fileName}`, editor);\n\t\teditor.fileDir = `${proj.name}:/${editor.fileName}`;\n\t\tif (!focusedEditor) {\n\t\t\tfocusedEditor = editor;\n\t\t}\n\t\teditors.push(editor);\n\t}\n\teditArea();\n}\nconst consoleElm = document.getElementById(\"console\") as HTMLDivElement;\nconsoleElm.append(cons.makeHtml());\nfunction executeArea() {\n\tarea.innerHTML = \"\";\n\n\teditButton.classList.remove(\"selected\");\n\texecuteButton.classList.add(\"selected\");\n\tcons.messageIClick();\n\tarea.append(system.createHTML());\n}\neditArea();\n"],"names":["AssemblError","Contextmenu","Editor","Console","Etab","I18n","Project","ProjFiles","actionRow","document","getElementById","Error","cons","done","fileMenu","addButton","file","new","newFile","click","open","openNewFile","save","focusedEditor","saveAll","editors","map","_","saveAs","downloadEditor","fileButton","createElement","textContent","append","bindContextmenu","undefined","menu","assemble","run","enabled","classList","contains","start","step","backStep","reset","runButton","area","onclick","system","disable","editor","length","curProject","dir","editMap","set","name","fileName","fileDir","push","editArea","setTimeout","editButton","executeButton","executeArea","buttons","Map","saved","checkIfReload","bool","window","onbeforeunload","editAreadiv","selectedTab","createRegiArea","regiArea","projFile","html","createHTML","innerHTML","tabs","add","remove","bu","get","button","addEventListener","e","saving","confirm","unsaved","delete","filter","createEditor","sys","giveError","console","error","getFile","text","addMessage","message","handSystem","saveAsm","string","h","startScreen","project","startProject","newProjectDialog","openFile","projectList","openExisting","thing","getProjects","openProject","dialog","body","p1","input","type","submit","value","alert","pleaseEnterName","proj","checkName","nameTaken","showModal","accept","onchange","files","newEditor","editorList","Array","from","arr","Promise","all","forEach","blob","Blob","a","download","href","URL","createObjectURL","dataset","downloadurl","join","style","display","appendChild","removeChild","revokeObjectURL","split","at","getAsm","consoleElm","makeHtml","messageIClick"],"mappings":"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"}