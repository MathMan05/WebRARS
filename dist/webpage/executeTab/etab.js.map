{"version":3,"sources":["../../../src/webpage/executeTab/etab.ts"],"sourcesContent":["import {CSymstem, runTimeError, Symstem} from \"../emulator/emulator.js\";\nimport {parseInt, toAsm} from \"../emulator/parseInt.js\";\nimport {registerNames} from \"../fetches.js\";\nimport {I18n} from \"../i18n.js\";\n\nclass Etab {\n\tprivate sys?: Symstem;\n\tprivate csys?: CSymstem;\n\tprivate csysQue: (undefined | CSymstem)[];\n\tprivate queEnd = 0;\n\tstarted = false;\n\trunning: undefined | Promise<void>;\n\tstopped = true;\n\thtmlMap = new Map<number, HTMLElement>();\n\tconstructor() {\n\t\tconst start = document.getElementById(\"start\") as HTMLElement;\n\t\tconst step = document.getElementById(\"step\") as HTMLElement;\n\t\tconst reset = document.getElementById(\"reset\") as HTMLElement;\n\t\tconst backStep = document.getElementById(\"backStep\") as HTMLElement;\n\t\tthis.csysQue = new Array(1000);\n\t\tstart.classList.add(\"disabled\");\n\t\tstep.classList.add(\"disabled\");\n\t\treset.classList.add(\"disabled\");\n\t\tbackStep.classList.add(\"disabled\");\n\t\tstart.onclick = () => {\n\t\t\tif (!start.classList.contains(\"disabled\")) {\n\t\t\t\tthis.start();\n\t\t\t}\n\t\t};\n\t\treset.onclick = () => {\n\t\t\tif (!reset.classList.contains(\"disabled\")) {\n\t\t\t\tthis.reset();\n\t\t\t}\n\t\t};\n\t\tstep.onclick = () => {\n\t\t\tif (!step.classList.contains(\"disabled\")) {\n\t\t\t\tthis.step();\n\t\t\t}\n\t\t};\n\t\tbackStep.onclick = () => {\n\t\t\tif (!backStep.classList.contains(\"disabled\")) {\n\t\t\t\tthis.backStep();\n\t\t\t}\n\t\t};\n\t}\n\tenque() {\n\t\tif (this.sys) {\n\t\t\tthis.csysQue[this.queEnd++ % 1000] = this.sys.compact();\n\t\t\tthis.queEnd %= 1000;\n\t\t}\n\t}\n\tbackStep() {\n\t\tlet elm = this.htmlMap.get(this.sys?.pc as number);\n\t\tif (elm) {\n\t\t\telm.classList.remove(\"running\");\n\t\t}\n\t\tconst back = this.csysQue[this.queEnd - 1];\n\t\tthis.csysQue[--this.queEnd] = undefined;\n\t\tthis.queEnd += 1000;\n\t\tthis.queEnd %= 1000;\n\t\tif (back) {\n\t\t\tthis.sys = back.unCompact();\n\t\t}\n\t\telm = this.htmlMap.get(this.sys?.pc as number);\n\t\tif (elm && this.sys && !this.sys.done) {\n\t\t\telm.classList.add(\"running\");\n\t\t}\n\t\tthis.changeButtonStates();\n\t\tthis.updateRegis();\n\t}\n\thandSystem(sys: Symstem) {\n\t\tthis.sys = sys;\n\t\tthis.csys = sys.compact();\n\t}\n\tasync reset() {\n\t\tif (!this.csys) return;\n\t\tlet elm = this.htmlMap.get(this.sys?.pc as number);\n\t\tif (elm) {\n\t\t\telm.classList.remove(\"running\");\n\t\t}\n\n\t\tthis.sys = this.csys.unCompact();\n\t\telm = this.htmlMap.get(this.sys.pc);\n\t\tif (elm && !this.sys.done) {\n\t\t\telm.classList.add(\"running\");\n\t\t}\n\t\tthis.csysQue = new Array(1000);\n\t\tthis.changeButtonStates();\n\t\tthis.updateRegis();\n\t}\n\tchangeButtonStates() {\n\t\tconst start = document.getElementById(\"start\") as HTMLButtonElement;\n\t\tconst step = document.getElementById(\"step\") as HTMLButtonElement;\n\t\tconst reset = document.getElementById(\"reset\") as HTMLButtonElement;\n\t\tconst backStep = document.getElementById(\"backStep\") as HTMLElement;\n\t\tif (this.sys) {\n\t\t\treset.classList.remove(\"disabled\");\n\t\t\tif (this.sys.done) {\n\t\t\t\tstart.classList.add(\"disabled\");\n\t\t\t\tstep.classList.add(\"disabled\");\n\t\t\t} else {\n\t\t\t\tstart.classList.remove(\"disabled\");\n\t\t\t\tstep.classList.remove(\"disabled\");\n\t\t\t}\n\t\t\tif (this.csysQue[this.queEnd - 1]) {\n\t\t\t\tbackStep.classList.remove(\"disabled\");\n\t\t\t} else {\n\t\t\t\tbackStep.classList.add(\"disabled\");\n\t\t\t}\n\t\t} else {\n\t\t\tstart.classList.add(\"disabled\");\n\t\t\tstep.classList.add(\"disabled\");\n\t\t\treset.classList.add(\"disabled\");\n\t\t\tbackStep.classList.add(\"disabled\");\n\t\t}\n\t}\n\thtmlRegMap = new WeakMap<HTMLElement, HTMLElement[]>();\n\tlastRegi: [number, boolean] = [-1, false];\n\tupdateRegis() {\n\t\tthis.updateLastUsed();\n\t\tconst regiArea = document.getElementById(\"regiArea\") as HTMLElement;\n\t\tif (!this.sys) {\n\t\t\tregiArea.innerHTML = \"\";\n\t\t\treturn;\n\t\t}\n\n\t\tlet elm = regiArea.children[0] as HTMLElement;\n\t\tif (elm) {\n\t\t\tconst arr = this.htmlRegMap.get(elm as HTMLElement);\n\t\t\tif (arr) {\n\t\t\t\tfor (let i = 0; i < 32; i++) {\n\t\t\t\t\tconst parent = arr[i].parentElement;\n\t\t\t\t\tif (parent) {\n\t\t\t\t\t\tif (!this.lastRegi[1] && this.lastRegi[0] === i) {\n\t\t\t\t\t\t\tparent.classList.add(\"LastUsed\");\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tparent.classList.remove(\"LastUsed\");\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tarr[i].textContent = \"0x\" + this.sys.UintRegis[i].toString(16).padStart(16, \"0\");\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tregiArea.innerHTML = \"\";\n\t\telm = document.createElement(\"table\");\n\t\telm.classList.add(\"regiTable\");\n\t\tconst regis: HTMLElement[] = [];\n\n\t\tconst tr = document.createElement(\"tr\");\n\t\tconst name = document.createElement(\"td\");\n\t\tname.textContent = I18n.regiTab.name();\n\t\tconst number = document.createElement(\"td\");\n\t\tnumber.textContent = I18n.regiTab.number();\n\t\tconst value = document.createElement(\"td\");\n\t\tvalue.textContent = I18n.regiTab.value();\n\t\ttr.append(name, number, value);\n\t\telm.append(tr);\n\n\t\tfor (let i = 0; i < 32; i++) {\n\t\t\tconst tr = document.createElement(\"tr\");\n\t\t\tconst name = document.createElement(\"td\");\n\t\t\tname.textContent = registerNames.int[i][1];\n\t\t\tconst number = document.createElement(\"td\");\n\t\t\tnumber.textContent = i + \"\";\n\t\t\tconst value = document.createElement(\"td\");\n\t\t\tregis.push(value);\n\t\t\ttr.append(name, number, value);\n\t\t\telm.append(tr);\n\t\t}\n\t\tregiArea.append(elm);\n\t\tthis.htmlRegMap.set(elm, regis);\n\t\tthis.updateRegis();\n\t}\n\tenableButtons() {\n\t\tthis.changeButtonStates();\n\t}\n\tdisable() {\n\t\tthis.sys = undefined;\n\t\tthis.running = undefined;\n\t\tthis.htmlMap = new Map();\n\t\tthis.started = false;\n\t\tthis.csysQue = new Array(1000);\n\t\tthis.changeButtonStates();\n\t}\n\tupdateLastUsed() {\n\t\ttry {\n\t\t\tconst past = this.csysQue[this.queEnd - 1];\n\t\t\tif (this.sys && past) {\n\t\t\t\tconst ram = past.ram.toRam();\n\t\t\t\tconst inst = ram.getInt32(past.pc);\n\t\t\t\tconst instruction = parseInt(inst);\n\t\t\t\tif (\"rd\" in instruction) {\n\t\t\t\t\tthis.lastRegi = [instruction.rd, false];\n\t\t\t\t}\n\t\t\t}\n\t\t} catch {}\n\t}\n\tasync start() {\n\t\tif (this.sys) {\n\t\t\tif (this.running) await this.running;\n\t\t\tthis.stopped = false;\n\t\t\tconst sys = this.sys;\n\t\t\tthis.running = new Promise<void>(async (res) => {\n\t\t\t\tlet elm = this.htmlMap.get(sys.pc);\n\t\t\t\tif (elm) {\n\t\t\t\t\telm.classList.remove(\"running\");\n\t\t\t\t}\n\t\t\t\ttry {\n\t\t\t\t\tdo {\n\t\t\t\t\t\tthis.enque();\n\t\t\t\t\t} while ((await sys.step()) && !this.stopped);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tif (e instanceof runTimeError) {\n\t\t\t\t\t\tsys.console.addIO(e.message, true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.error(e);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.updateRegis();\n\t\t\t\telm = this.htmlMap.get(sys.pc);\n\t\t\t\tif (elm && !sys.done) {\n\t\t\t\t\telm.classList.add(\"running\");\n\t\t\t\t}\n\t\t\t\tres();\n\t\t\t\tthis.changeButtonStates();\n\t\t\t\tthis.running = undefined;\n\t\t\t});\n\t\t}\n\t}\n\tasync step() {\n\t\tif (this.running) return await this.running;\n\t\tthis.running = new Promise<void>(async (res) => {\n\t\t\tif (this.sys) {\n\t\t\t\tlet elm = this.htmlMap.get(this.sys.pc);\n\t\t\t\tif (elm) {\n\t\t\t\t\telm.classList.remove(\"running\");\n\t\t\t\t}\n\n\t\t\t\tthis.enque();\n\t\t\t\tconst sys = this.sys;\n\t\t\t\ttry {\n\t\t\t\t\tawait sys.step();\n\t\t\t\t} catch (e) {\n\t\t\t\t\tif (e instanceof runTimeError) {\n\t\t\t\t\t\tsys.console.addIO(e.message, true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.error(e);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telm = this.htmlMap.get(this.sys.pc);\n\t\t\t\tif (elm && !sys.done) {\n\t\t\t\t\telm.classList.add(\"running\");\n\t\t\t\t}\n\t\t\t\tthis.updateRegis();\n\t\t\t}\n\t\t\tres();\n\t\t\tthis.changeButtonStates();\n\t\t\tthis.running = undefined;\n\t\t});\n\t}\n\tcreateHTML() {\n\t\tthis.htmlMap = new Map();\n\t\tconst div = document.createElement(\"div\");\n\t\tdiv.classList.add(\"flexttb\", \"dontgrow\");\n\t\tconst scrollTable = document.createElement(\"div\");\n\t\tconst table = document.createElement(\"table\");\n\t\tscrollTable.append(table);\n\t\tdiv.append(scrollTable);\n\t\tscrollTable.classList.add(\"scrollTable\");\n\t\tconst tr = document.createElement(\"tr\");\n\t\tconst address = document.createElement(\"th\");\n\t\taddress.textContent = I18n.address();\n\t\ttr.append(address);\n\n\t\tconst code = document.createElement(\"th\");\n\t\tcode.textContent = I18n.code();\n\t\ttr.append(code);\n\n\t\tconst basic = document.createElement(\"th\");\n\t\tbasic.textContent = I18n.basic();\n\t\ttr.append(basic);\n\t\ttable.append(tr);\n\t\tif (this.sys) {\n\t\t\tthis.enableButtons();\n\t\t\tlet val: number;\n\n\t\t\tfor (let i = 0x00400000; (val = this.sys.ram.getInt32(i)) !== 0; i += 4) {\n\t\t\t\tconst tr = document.createElement(\"tr\");\n\t\t\t\tthis.htmlMap.set(i, tr);\n\t\t\t\tif (i === this.sys.pc && !this.sys.done) {\n\t\t\t\t\ttr.classList.add(\"running\");\n\t\t\t\t}\n\t\t\t\tconst address = document.createElement(\"td\");\n\t\t\t\taddress.textContent = \"0x\" + i.toString(16).padStart(8, \"0\");\n\t\t\t\ttr.append(address);\n\n\t\t\t\tconst code = document.createElement(\"td\");\n\t\t\t\tcode.textContent = \"0x\" + (val >>> 0).toString(16).padStart(8, \"0\");\n\t\t\t\ttr.append(code);\n\n\t\t\t\tconst basic = document.createElement(\"td\");\n\t\t\t\tbasic.textContent = toAsm(val);\n\t\t\t\ttr.append(basic);\n\t\t\t\ttable.append(tr);\n\t\t\t}\n\t\t}\n\t\tthis.updateRegis();\n\t\treturn div;\n\t}\n}\nexport {Etab};\n"],"names":["runTimeError","parseInt","toAsm","registerNames","I18n","Etab","sys","csys","csysQue","queEnd","started","running","stopped","htmlMap","Map","constructor","start","document","getElementById","step","reset","backStep","Array","classList","add","onclick","contains","enque","compact","elm","get","pc","remove","back","undefined","unCompact","done","changeButtonStates","updateRegis","handSystem","htmlRegMap","WeakMap","lastRegi","updateLastUsed","regiArea","innerHTML","children","arr","i","parent","parentElement","textContent","UintRegis","toString","padStart","createElement","regis","tr","name","regiTab","number","value","append","int","push","set","enableButtons","disable","past","ram","toRam","inst","getInt32","instruction","rd","Promise","res","e","console","addIO","message","error","createHTML","div","scrollTable","table","address","code","basic","val"],"mappings":"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"}